# vue-table-print

[![npm version](https://badge.fury.io/js/vue-table-print.svg)](https://badge.fury.io/js/vue-table-print)
[![downloads](https://img.shields.io/npm/dm/vue-table-print.svg)](https://npmjs.org/package/vue-table-print)
[![license](https://img.shields.io/npm/l/vue-table-print.svg)](https://github.com/yourusername/vue-table-print/blob/main/LICENSE)

ä¸€ä¸ªå¼ºå¤§çš„Vue 3è¡¨æ ¼æ‰“å°å·¥å…·ï¼Œæ”¯æŒElementPlusã€Ant Design Vueç­‰ä¸»æµUIç»„ä»¶åº“ã€‚

## ç‰¹æ€§

- ğŸš€ **Vue 3 + TypeScript** - å®Œæ•´çš„ç±»å‹æ”¯æŒ
- ğŸ“± **å“åº”å¼è®¾è®¡** - é€‚é…ä¸åŒå±å¹•å’Œæ‰“å°å°ºå¯¸
- ğŸ¨ **é«˜åº¦å¯å®šåˆ¶** - æ”¯æŒè‡ªå®šä¹‰æ ·å¼ã€æ°´å°ã€Logoç­‰
- ğŸ“„ **å¤šç§å¯¼å‡ºæ ¼å¼** - æ”¯æŒæ‰“å°ã€é¢„è§ˆã€å¯¼å‡ºHTML
- ğŸ”§ **çµæ´»é…ç½®** - ä¸°å¯Œçš„é…ç½®é€‰é¡¹æ»¡è¶³ä¸åŒéœ€æ±‚
- ğŸ“¦ **è½»é‡çº§** - é›¶ä¾èµ–ï¼Œä½“ç§¯å°å·§
- ğŸ¯ **æ˜“äºä½¿ç”¨** - ç®€å•çš„APIè®¾è®¡ï¼Œå¿«é€Ÿä¸Šæ‰‹

## å®‰è£…

```bash
# npm
npm install vue-table-print

# yarn
yarn add vue-table-print

# pnpm
pnpm add vue-table-print
```

## å¿«é€Ÿå¼€å§‹

### åŸºç¡€ç”¨æ³•

```vue
<template>
  <div>
    <el-button @click="handlePrint">æ‰“å°è¡¨æ ¼</el-button>
    <el-table :data="tableData">
      <el-table-column prop="name" label="å§“å" />
      <el-table-column prop="age" label="å¹´é¾„" />
      <el-table-column prop="department" label="éƒ¨é—¨" />
    </el-table>
  </div>
</template>

<script setup>
import { useTablePrint } from 'vue-table-print'

const { printTable } = useTablePrint({
  title: 'å‘˜å·¥ä¿¡æ¯è¡¨'
})

const tableData = [
  { name: 'å¼ ä¸‰', age: 28, department: 'æŠ€æœ¯éƒ¨' },
  { name: 'æå››', age: 32, department: 'äº§å“éƒ¨' }
]

const columns = [
  { prop: 'name', label: 'å§“å' },
  { prop: 'age', label: 'å¹´é¾„', align: 'center' },
  { prop: 'department', label: 'éƒ¨é—¨' }
]

const handlePrint = async () => {
  const result = await printTable(tableData, columns)
  if (!result.success) {
    console.error('æ‰“å°å¤±è´¥:', result.message)
  }
}
</script>
```

### ç±»å®ä¾‹ç”¨æ³•

```javascript
import { TablePrintUtil } from 'vue-table-print'

const printUtil = new TablePrintUtil({
  title: 'æ•°æ®æŠ¥è¡¨',
  pageSize: 'A4',
  orientation: 'landscape'
})

// æ‰“å°è¡¨æ ¼
await printUtil.printTable(data, columns)

// é¢„è§ˆè¡¨æ ¼
printUtil.previewTable(data, columns)

// å¯¼å‡ºHTML
printUtil.exportToHTML(data, columns, 'report.html')
```

## APIå‚è€ƒ

### PrintOptions é…ç½®é€‰é¡¹

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| title | string | 'æ•°æ®è¡¨æ ¼' | æ‰“å°æ ‡é¢˜ |
| showHeader | boolean | true | æ˜¯å¦æ˜¾ç¤ºé¡µå¤´ |
| showFooter | boolean | true | æ˜¯å¦æ˜¾ç¤ºé¡µè„š |
| pageSize | 'A4' \| 'A3' \| 'A5' \| 'Letter' | 'A4' | é¡µé¢å°ºå¯¸ |
| orientation | 'portrait' \| 'landscape' | 'portrait' | é¡µé¢æ–¹å‘ |
| margins | string | '1cm' | é¡µé¢è¾¹è· |
| fontSize | string | '12px' | å­—ä½“å¤§å° |
| headerStyle | object | - | è¡¨å¤´æ ·å¼é…ç½® |
| customStyles | string | '' | è‡ªå®šä¹‰CSSæ ·å¼ |
| watermark | string | '' | æ°´å°æ–‡å­— |
| logo | string | '' | Logoå›¾ç‰‡URL |

### TableColumn åˆ—é…ç½®

| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| prop | string | æ•°æ®å­—æ®µå |
| label | string | åˆ—æ ‡é¢˜ |
| align | 'left' \| 'center' \| 'right' | å¯¹é½æ–¹å¼ |
| width | number \| string | åˆ—å®½åº¦ |
| formatter | function | æ ¼å¼åŒ–å‡½æ•° |

### æ–¹æ³•

#### useTablePrint(options?)

ç»„åˆå¼å‡½æ•°ï¼Œè¿”å›æ‰“å°ç›¸å…³æ–¹æ³•ã€‚

```javascript
const { printTable, previewTable, exportToHTML } = useTablePrint(options)
```

#### printTable(data, columns, options?)

æ‰“å°è¡¨æ ¼æ•°æ®ã€‚

- **data**: `any[]` - è¡¨æ ¼æ•°æ®
- **columns**: `TableColumn[]` - åˆ—é…ç½®
- **options**: `Partial<PrintOptions>` - å¯é€‰é…ç½®
- **è¿”å›**: `Promise<PrintResult>` - æ‰“å°ç»“æœ

#### previewTable(data, columns, options?)

é¢„è§ˆè¡¨æ ¼æ‰“å°æ•ˆæœã€‚

#### exportToHTML(data, columns, filename?, options?)

å¯¼å‡ºä¸ºHTMLæ–‡ä»¶ã€‚

## é«˜çº§ç”¨æ³•

### è‡ªå®šä¹‰æ ¼å¼åŒ–

```javascript
const columns = [
  {
    prop: 'salary',
    label: 'è–ªèµ„',
    align: 'right',
    formatter: (row, column, value) => `ï¿¥${value.toLocaleString()}`
  },
  {
    prop: 'status',
    label: 'çŠ¶æ€',
    formatter: (row) => row.status === 1 ? 'åœ¨èŒ' : 'ç¦»èŒ'
  }
]
```

### æ·»åŠ æ°´å°å’ŒLogo

```javascript
const { printTable } = useTablePrint({
  title: 'æœºå¯†æ–‡æ¡£',
  watermark: 'å†…éƒ¨èµ„æ–™',
  logo: '/path/to/company-logo.png'
})
```

### è‡ªå®šä¹‰æ ·å¼

```javascript
const customOptions = {
  customStyles: `
    .print-table th {
      background-color: #1890ff !important;
      color: white !important;
    }
    .print-table td {
      border-color: #1890ff !important;
    }
  `
}

await printTable(data, columns, customOptions)
```

### æ¨ªå‘æ‰“å°å¤§è¡¨æ ¼

```javascript
await printTable(data, columns, {
  orientation: 'landscape',
  pageSize: 'A3',
  fontSize: '10px'
})
```

## æµè§ˆå™¨å…¼å®¹æ€§

- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+

## å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆæ‰“å°çª—å£è¢«æ‹¦æˆªï¼Ÿ
A: ç°ä»£æµè§ˆå™¨ä¼šæ‹¦æˆªå¼¹çª—ï¼Œè¯·å…è®¸å½“å‰ç½‘ç«™çš„å¼¹çª—æƒé™ã€‚

### Q: å¦‚ä½•è‡ªå®šä¹‰æ‰“å°æ ·å¼ï¼Ÿ
A: ä½¿ç”¨ `customStyles` é€‰é¡¹æ·»åŠ è‡ªå®šä¹‰CSSï¼Œæˆ–é€šè¿‡ `headerStyle` é…ç½®è¡¨å¤´æ ·å¼ã€‚

### Q: æ”¯æŒå“ªäº›UIç»„ä»¶åº“ï¼Ÿ
A: æœ¬åº“æ˜¯UIç»„ä»¶åº“æ— å…³çš„ï¼Œæ”¯æŒElementPlusã€Ant Design Vueã€Naive UIç­‰æ‰€æœ‰Vue 3ç»„ä»¶åº“ã€‚

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## License

MIT License

## æ›´æ–°æ—¥å¿—

### v1.0.0
- ğŸ‰ é¦–æ¬¡å‘å¸ƒ
- âœ¨ æ”¯æŒåŸºç¡€æ‰“å°åŠŸèƒ½
- âœ¨ æ”¯æŒé¢„è§ˆå’Œå¯¼å‡ºHTML
- âœ¨ å®Œæ•´çš„TypeScriptæ”¯æŒ